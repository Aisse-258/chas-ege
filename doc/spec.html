<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8"/>
	<script>
		document.write('<script src="../lib/head.js?'+Math.random()+'"></sc'+'ript>');
	</script>
	<script>
		addstyle("../css/pech.css");
	</script>
	<title>
		Тренажёр "Час ЕГЭ" - сведения об архитектуре программы
	</title>
</head>
<body>
	<script>
		document.write('<script src="../lib/init.js?'+Math.random()+'"></sc'+'ript>');
	</script>
	<h2>
		Файловая структура		
	</h2>
	"Час ЕГЭ" - это, вообще говоря, программа, предназначенная для выполнения в браузере. 
	Поэтому её можно, например, скачать в виде архива, распаковать и использовать с жёсткого диска ЭВМ.
	Программа эта состоит из файлов, разложенных по папкам.
	Ниже представлены папки с описанием их назначения.
	<br/>
	<table class="normtabl">
		<tr>
			<th>
				Папка
			</th>
			<th>
				Типы файлов
			</th>
			<th>
				Пояснение
			</th>
		</tr>
		<tr>
			<td>
				/css
			</td>
			<td>
				*.css
			</td>
			<td>
				Стили оформления выносятся в отдельную папку, так как могут быть общими, например, для оболочек и документации.
			</td>
		</tr>
		<tr>
			<td>
				/dev
			</td>
			<td>
				*
			</td>
			<td>
				Черновики всевозможных "запчастей" от системы. Для разработчиков там может что-то быть и интересно, а на рабочий сервер её вовсе заливать необязательно.
			</td>
		</tr>
		<tr>
			<td>
				/doc
			</td>
			<td>
				*.html
			</td>
			<td>
				Документация к системе "Час ЕГЭ": лицензия, справка...
			</td>
		</tr>
		<tr>
			<td>
				/ext
			</td>
			<td>
				*
			</td>
			<td>
				Внешние библиотеки и подключаемые модули.
				На 22 июляя 2013 года таких шесть: MathJax, JQuery, Greyvyvern's Keyboard, AnythingSlider, jqPlot и шрифты семейства Liberation.
			</td>
		</tr>
		<tr>
			<td>
				/lib
			</td>
			<td>
				*.js<br/>
				*.html
			</td>
			<td>
				Внутренние библиотеки и подключаемые модули.
				"Главный" файл - <em>init.js</em> , он подключает и готовит всё остальное.
				Особо отметим файлы, расширяющие существующие типы данных в Javascript
				- например, <em>array.js</em> , <em>number.js</em> и им подобные.
			</td>
		</tr>
		<tr>
			<td>
				/sh
			</td>
			<td>
				*.html<br/>
				*.js
			</td>
			<td>
				Оболочки - странички, запускающие задания.
				Рядом - скрипты, в которые все алгоритмы выбора и запуска заданий и вынесены.
				По состоянию на 22 июля 2013 года оболочек три: <a href="../sh/sluch.html">случайное задание</a>, <a href="../sh/otladka.html">режим отладки</a> и <a href="../sh/pechmat.html">создание теста на печать</a>.
				Запланирована разработка оболочки в виде интерактивного теста.
			</td>
		</tr>
		<tr>
			<td>
				/zdn
			</td>
			<td>
				*/*/*.js
			</td>
			<td>
				Здесь файловая структура является вложенной.
				Первый подуровень - название предмета или комплекта заданий.
				По состоянию на 22 июля 2013 года такой предмет только один - математика <em>mat/</em> .
				Второй подуровень - название задания, его формат согласуется с оболочкой.
				В папке каждого задания находятся файлы <em>main.js</em> , отвечающий за равновероятный вызов шаблона,
				и шаблоны заданий <em>1.js</em> , <em>2.js</em> ... <em>*.js</em>.
			</td>
		</tr>
		<!--
		<tr>
			<td>
				/
			</td>
			<td>
				*.
			</td>
			<td>
			</td>
		</tr>
		-->
	</table>
	<h2>
		Понятие шаблона
	</h2>
	Шаблон - это ровно один файл *.js, который составляет задание, пользуясь библиотеками.
	Составленное задание записывается в глобальный объект <em>window.vopr</em> .
	Возможно, имеет смысл оборачивать каждый шаблон в замыкание. Особенно после отладки.
	Шаблон может составлять задание как генеративного типа - подбирать каждый раз новые цифры, так и коллекционного., т. е. содержать неизменяемый текст.
	В случае совмещения этих двух типов следует с помощью <em>main.js</em> отрегулировать частоты их появления.
	Если в шаблоне требуется использовать картинку, задавайте её с помощью base64.
	<h2>
		Принцип модульности
	</h2>
	<ul>
		<li>
			<em>main.js</em> знает, сколько у него в папке шаблонов, но не знает, в какой папке он лежит.
		</li>
		<li>
			Шаблон не знает, в какой папке он лежит.
		</li>
		<li>
			Оболочка не знает, сколько шаблонов в каждом задании.
		</li>
	</ul>
	Такая архитектура, хоть и требует постоянной подгрузки скриптов, обеспечивает:
	<ul>
		<li>
			возможность независимой разработки шаблонов;
		</li>
		<li>
			лёгкость перегруппировки заданий и отдельных шаблонов.
		</li>
	</ul>
	<h2>
		Глобальный объект window.vopr
	</h2>
	Объект <em>window.vopr</em> предназначен для хранения составленного задания и имеет ряд свойств:
	<table class="normtabl">
		<tr>
			<th>Свойство
			</th>
			<th>
				Тип
			</th>
			<th>
				Значение по умолчанию
			</th>
			<th>
				Пояснение
			</th>
		</tr>
		<tr>
			<td>
				txt
			</td>
			<td>
				Строка
			</td>
			<td>
				''
			</td>
			<td>
				Формулировка вопроса - html-текст.
			</td>
		</tr>
		<tr>
			<td>
				rsh
			</td>
			<td>
				Строка
			</td>
			<td>
				'Разбор решения этой задачи ещё не подготовлен.'
			</td>
			<td>
				Строка с разбором решения. По состоянию на 22 июля 2013 года не используется.
			</td>
		</tr>
		<tr>
			<td>
				ver
			</td>
			<td>
				Массив нумерованный
			</td>
			<td>
				[]
			</td>
			<td>
				Массив со всеми возможными верными ответами.
				В большинстве случаев состоит из одного элемента.
			</td>
		</tr>
		<tr>
			<td>
				nev
			</td>
			<td>
				Массив нумерованный
			</td>
			<td>
				[]
			</td>
			<td>
				Массив с несколькими неверными ответами.
				Заложен на будущее, если потребуется составлять задания А-части.
			</td>
		</tr>
		<tr>
			<td>
				dey
			</td>
			<td>
				Функция
			</td>
			<td>
				function(){}
			</td>
			<td>
				Функция, выполняемая <b>после</b> отображения текста задания. 
				По состоянию на 22 июля 2013 года используется только для отрисовки canvas.
			</td>
		</tr>
		<tr>
			<td>
				kat
			</td>
			<td>
				Массив именованный
			</td>
			<td>
				[]
			</td>
			<td>
				Содержит отметки о теме задания, например, если отмечено, 
				что <em>window.vopr.kat["log"]=1</em>, значит, задание требует умения обращаться с логарифмами.
				Используется для исключения заданий на темы, ещё не освоенные учащимися.
			</td>
		</tr>
		<tr>
			<td>
				vrn
			</td>
			<td>
				Функция
			</td>
			<td>
				function(kand){<br/>
		var fl=0;<br/>
		for(var i2=0;i2&lt;this.ver.length;i2++){<br/>
			fl+=(this.ver[i2].toStandart()==kand.toStandart())<br/>
		}<br/>
		return fl;<br/>
	};
			</td>
			<td>
				Функция, определяющая, является ли ответ верным. Нужна, например, в тех случаях, когда верных ответов бесконечно много.
				По умолчанию проверяет, находится ли ответ в массиве верных ответов.
			</td>
		</tr>
	</table>
	<br/>
	Для установки всех свойств в значение по умолчанию используется функция <em>window.vopr.podg()</em> .
</body>
</html>
