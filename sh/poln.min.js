$("#zadaniya").html("");for(var i=1;i<=nabor.nZad;i++)document.getElementById("zadaniya").innerHTML+='<tr><td><label for="cB'+i+'" >'+nabor.prefix+i+'</label></td><td><input type="text" class="kolvo" value="1" id="cB'+i+'" data-jstorage-id="poln-cB'+i+'"></td></tr>';$("#gotov").hide();var vr1=svinta?100:200,vr2=svinta?100:1500,startxt="";window.vopr.txt="";var intervPole,nV=1,nZ=1,aZ=[],iZ=[],aV,strVopr="",strOtv="",voprosy=[];
function vse1(){for(var a=1;a<=nabor.nZad;a++)$("#cB"+a).val(1);$("#cV").val(1)}function vse0(){for(var a=1;a<=nabor.nZad;a++)$("#cB"+a).val(0);$("#cV").val(1)}function zapusk(){$.jStorage.sohrData();for(var a=1;a<=nabor.nZad;a++)aZ[a]=1*$("#cB"+a).val();cacheKat();(kZ=aZ.sum())?(iZ=aZ.slice(),nZ=1,$("#panel").html("Тест составляется, подождите..."),$("#gotov").show(),zadan()):alert("Ни одно задание не выбрано.")}
function testGotov(){$("#gotov").hide();allCanvasToBackgroundImage();$("#panel").remove();alert("Тест составлен.\nМожно приступать к решению!")}function konecSozd(){$("#prov_knopki").show();MathJax.Hub.Typeset("rez",testGotov)}function zadan(){nZ>nabor.nZad?konecSozd():0==iZ[nZ]?(nZ++,zadan()):(iZ[nZ]--,zagr(nabor.adres+nabor.prefix+nZ+"/main.js"),vopr.podg(),intervPole=setTimeout("zagr(nabor.adres+nabor.prefix+nZ+'/'+nomer+'.js');",vr1),intervPole=setTimeout("obnov();",vr1+vr2))}
function obnov(){if(0!=window.vopr.txt&&startxt!=window.vopr.txt){clearInterval(intervPole);if(sootvKat()){var a=aZ.sum()-iZ.sum();starttxt=window.vopr.txt;strVopr='<br/><div class="d"><div class="b">B'+nZ+(1==aZ[nZ]?"":"-"+(aZ[nZ]-iZ[nZ]))+"</div>"+window.vopr.txt+'<div class="r">Ответ:<textarea class="text_otv" rows="1"></textarea><div class="otv_ver" id="otv_ver'+(a-1)+'">Правильно!</div><div class="otv_nev" id="otv_nev'+(a-1)+'">Неправильно!<br/>Правильный ответ: '+window.vopr.ver.join("или")+
"</div></div>";var b=document.createElement("div");b.innerHTML=strVopr;b["class"]="d d3";b.width="100%";document.getElementById("rez").appendChild(b);try{window.vopr.dey()}catch(d){}voprosy.push(vopr.clone());b=a/kZ;$(".tx").text((100*b).toFixedLess(1).dopdo(" ",4)+"%");$("#pr1").width($("#pr0").width()*b);b=(vr1+vr2)*(kZ-a)/1E3;$("#vrem").text(a+" из "+kZ+" "+b.toDvoet())}else iZ[nZ]++;zadan()}else setTimeout("zagr('nabor.adres+nabor.prefix+"+nZ+"+'/'+nomer+'.js');",vr1),intervPole=setTimeout("obnov();",
vr1+vr2)}function prov(){var a=0,b=0,d=$("textarea");console.log(d[0]);for(var c=0;c<aZ.sum();c++)voprosy[c].vrn.call(voprosy[c],d[c].value)?(a++,$("#otv_ver"+c).show()):(b++,$("#otv_nev"+c).show());$("#but_prov").hide();$("#prov_knopki").append("<br/>Правильно решено "+chislitlx(a,"задание")+" из "+aZ.sum())}galkiKat("#galki_kat","pech");$("#prov_knopki").hide();
